import{d as Pe,y as h,c as Ee,E as je,K as Se,a as r,o as u,e as a,u as l,h as Ye,w as n,b as t,l as ue,t as i,f as b,i as M,F as V,r as $,P as N,v as Ie,g as A}from"./app-ZwxVz8fK.js";import{v as R,S as ze,_ as Ve}from"./AppLayout.vue_vue_type_script_setup_true_lang-C95gl-vp.js";import{_ as k}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-Bc2FUxRI.js";import{_ as P,a as E,b as j,d as D,c as S}from"./CardTitle.vue_vue_type_script_setup_true_lang-CrDShhRO.js";import{d as Ae}from"./index-CwYsXsqK.js";import{A as Fe}from"./arrow-left-vSIsoHd_.js";import{P as re}from"./play-Bjv4gLVa.js";import{P as Me,R as $e,V as Ne,a as Re,M as De}from"./volume-x-QbF6RKLd.js";import"./useForwardExpose-CpiEZE3t.js";import"./VisuallyHidden-BSpMzYLY.js";import"./RovingFocusGroup-6s-SpxoV.js";import"./useArrowNavigation-B5rxJs06.js";import"./createLucideIcon-Cpl7NutW.js";const Le={class:"flex h-full flex-1 flex-col gap-6 overflow-x-auto rounded-xl p-6"},Be={class:"flex items-center justify-between"},Ue={class:"flex items-center gap-4"},Ke={class:"text-muted-foreground"},qe={class:"flex gap-2"},Qe={class:"grid grid-cols-1 lg:grid-cols-4 gap-6"},Ze={class:"lg:col-span-3"},Ge={class:"video-container relative aspect-video bg-black rounded-lg overflow-hidden group"},He={key:0,id:"youtube-player-preview",class:"w-full h-full"},Xe=["src"],Je={class:"absolute inset-0 pointer-events-none"},Oe=["onClick"],We={key:0,class:"h-full flex items-center justify-center"},et=["src","alt"],tt={key:3,class:"w-full h-full flex flex-col justify-center p-2"},st={class:"text-sm font-medium mb-2"},ot={class:"space-y-1"},lt=["onClick"],at=["href"],nt={key:5,class:"w-full h-full"},it={key:6,class:"w-full h-full flex items-center justify-center text-xs text-gray-500"},ut={key:3,class:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50"},rt={class:"mt-4 space-y-4"},dt={class:"space-y-2"},ct={class:"flex justify-between text-sm text-muted-foreground"},ft={class:"relative"},vt={class:"w-full h-2 bg-muted rounded-full"},pt=["value","max"],_t={class:"flex items-center justify-between"},yt={class:"flex items-center gap-4"},gt={class:"flex items-center gap-2"},mt={class:"w-20"},ht=["value"],bt={class:"space-y-4"},xt={class:"font-semibold"},wt={class:"text-sm text-muted-foreground"},kt={class:"text-sm text-muted-foreground"},Tt={key:0,class:"space-y-2"},Ct={class:"font-medium"},Pt={class:"text-muted-foreground capitalize"},Et={class:"text-xs text-muted-foreground mt-1"},jt={key:0,class:"text-xs text-muted-foreground truncate"},St={key:1,class:"text-sm text-muted-foreground text-center py-4"},Yt={class:"flex justify-between"},It={class:"font-mono"},zt={class:"flex justify-between"},Vt={class:"font-mono"},At={class:"flex justify-between"},Ft={class:"font-mono"},Mt={class:"flex justify-between"},$t={class:"font-mono"},Nt={class:"flex justify-between"},Rt={class:"font-mono"},Dt={class:"flex justify-between"},Lt={class:"font-mono"},ss=Pe({__name:"Preview",props:{video:{}},setup(de){const ce=[{title:"Dashboard",href:Ae.url()},{title:"Videos",href:R.index.url()},{title:"Preview Video",href:"#"}],F=de,c=h(null),d=h(null),p=h(!1),v=h(0),y=h(0),Y=h(1),g=h(!1),L=h(!1),m=h(!1),I=()=>{m.value&&d.value?p.value?d.value.pauseVideo():d.value.playVideo():c.value&&(p.value?(c.value.pause(),p.value=!1):c.value.play().then(()=>{p.value=!0}).catch(s=>{}))},fe=s=>{m.value&&d.value?(d.value.seekTo(s,!0),v.value=s):c.value&&(c.value.currentTime=s,v.value=s)},ve=s=>{m.value&&d.value?(d.value.setVolume(s*100),Y.value=s,g.value=s===0):c.value&&(c.value.volume=s,Y.value=s,g.value=s===0)},B=()=>{m.value&&d.value?g.value?(d.value.unMute(),g.value=!1):(d.value.mute(),g.value=!0):c.value&&(g.value?(c.value.volume=Y.value,g.value=!1):(c.value.volume=0,g.value=!0))},U=()=>{document.fullscreenElement?(document.exitFullscreen(),L.value=!1):(document.documentElement.requestFullscreen(),L.value=!0)},K=()=>{m.value&&d.value?(d.value.seekTo(0,!0),v.value=0):c.value&&(c.value.currentTime=0,v.value=0)},pe=()=>{c.value&&(v.value=c.value.currentTime)},_e=()=>{c.value&&(y.value=c.value.duration)},ye=()=>{p.value=!1},z=Ee(()=>{var s;return((s=F.video.interactive_elements)==null?void 0:s.filter(o=>o.is_active&&v.value>=o.start_time&&v.value<=(o.end_time||o.start_time+o.duration)))||[]}),x=s=>{const o=Math.floor(s/60),e=Math.floor(s%60);return`${o}:${e.toString().padStart(2,"0")}`},ge=s=>{var o,e,f,_;switch(s.type){case"button":((o=s.content)==null?void 0:o.action)==="popup"?alert(((e=s.content)==null?void 0:e.popupText)||"Button clicked!"):((f=s.content)==null?void 0:f.action)==="link"&&((_=s.content)!=null&&_.url)&&window.open(s.content.url,"_blank");break}},me=(s,o)=>{var _;const e=((_=s.content)==null?void 0:_.correctAnswer)||0;alert(o===e?"Correct answer!":"Incorrect answer. Try again!")},q=s=>{switch(s.code){case"Space":s.preventDefault(),I();break;case"KeyM":B();break;case"KeyF":U();break;case"KeyR":K();break}},Q=()=>{if(typeof window<"u"&&window.YT&&window.YT.Player){const s=he(F.video.source_url);s&&(d.value=new window.YT.Player("youtube-player-preview",{height:"100%",width:"100%",videoId:s,playerVars:{autoplay:0,controls:1,showinfo:0,rel:0,modestbranding:1,fs:1,cc_load_policy:0,iv_load_policy:3,autohide:0,enablejsapi:1,origin:window.location.origin},events:{onReady:be,onStateChange:xe,onError:we}}))}},he=s=>{const o=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([a-zA-Z0-9_-]{11})/,/youtube\.com\/watch\?.*v=([a-zA-Z0-9_-]{11})/];for(const e of o){const f=s.match(e);if(f)return f[1]}return null},be=s=>{y.value=s.target.getDuration(),m.value=!0,ke()},xe=s=>{const o=s.data;o===window.YT.PlayerState.PLAYING?p.value=!0:(o===window.YT.PlayerState.PAUSED||o===window.YT.PlayerState.ENDED)&&(p.value=!1)},we=s=>{};let w=null;const ke=()=>{w&&clearInterval(w),w=setInterval(()=>{d.value&&d.value.getCurrentTime&&(v.value=d.value.getCurrentTime())},100)},Te=()=>{w&&(clearInterval(w),w=null)};je(()=>{var s;if(document.addEventListener("keydown",q),m.value=F.video.source_type==="youtube",m.value)if(typeof window<"u"&&window.YT&&window.YT.Player)Q();else{const o=document.createElement("script");o.src="https://www.youtube.com/iframe_api";const e=document.getElementsByTagName("script")[0];(s=e.parentNode)==null||s.insertBefore(o,e),window.onYouTubeIframeAPIReady=()=>{Q()}}});const Ce=s=>{var o,e,f,_,T,C;return s.type!=="image"?"":((o=s.content)==null?void 0:o.sourceType)==="upload"&&((e=s.content)!=null&&e.uploadedFile)?s.content.uploadedFile:((f=s.content)==null?void 0:f.sourceType)==="url"&&((_=s.content)!=null&&_.url)||(T=s.content)!=null&&T.url?s.content.url:(C=s.content)!=null&&C.imageUrl?s.content.imageUrl:"https://picsum.photos/200/100"};return Se(()=>{document.removeEventListener("keydown",q),Te(),d.value&&d.value.destroy()}),(s,o)=>(u(),r(V,null,[a(l(Ye),{title:"Preview Video"}),a(Ve,{breadcrumbs:ce},{default:n(()=>[t("div",Le,[t("div",Be,[t("div",Ue,[a(l(ue),{href:l(R).edit.url({video:s.video.id})},{default:n(()=>[a(l(k),{variant:"outline",size:"sm"},{default:n(()=>[a(l(Fe),{class:"h-4 w-4"})]),_:1})]),_:1},8,["href"]),t("div",null,[o[2]||(o[2]=t("h1",{class:"text-3xl font-bold tracking-tight"},"Preview Video",-1)),t("p",Ke,i(s.video.title),1)])]),t("div",qe,[a(l(ue),{href:l(R).edit.url({video:s.video.id})},{default:n(()=>[a(l(k),{variant:"outline",class:"gap-2"},{default:n(()=>[a(l(ze),{class:"h-4 w-4"}),o[3]||(o[3]=b(" Edit Video ",-1))]),_:1,__:[3]})]),_:1},8,["href"])])]),t("div",Qe,[t("div",Ze,[a(l(P),null,{default:n(()=>[a(l(E),null,{default:n(()=>[a(l(j),null,{default:n(()=>o[4]||(o[4]=[b("Interactive Video Preview",-1)])),_:1,__:[4]}),a(l(D),null,{default:n(()=>o[5]||(o[5]=[b(" Test your interactive elements in real-time ",-1)])),_:1,__:[5]})]),_:1}),a(l(S),null,{default:n(()=>[t("div",Ge,[s.video.source_type==="youtube"?(u(),r("div",He)):(u(),r("video",{key:1,ref_key:"videoRef",ref:c,src:`/storage/${s.video.video_path}`,class:"w-full h-full object-contain",onTimeupdate:pe,onLoadedmetadata:_e,onEnded:ye,onClick:I},null,40,Xe)),t("div",Je,[(u(!0),r(V,null,$(z.value,e=>{var f,_,T,C,Z,G,H,X,J,O,W,ee,te,se,oe,le,ae;return u(),r("div",{key:e.id,style:N({position:"absolute",left:e.position.x+"px",top:e.position.y+"px",width:e.position.width+"px",height:e.position.height+"px",backgroundColor:((f=e.styling)==null?void 0:f.backgroundColor)||"#ffffff",color:((_=e.styling)==null?void 0:_.textColor)||"#000000",fontSize:(((T=e.styling)==null?void 0:T.fontSize)||16)+"px",fontFamily:((C=e.styling)==null?void 0:C.fontFamily)||"Arial",borderRadius:(((Z=e.styling)==null?void 0:Z.borderRadius)||4)+"px",padding:(((G=e.styling)==null?void 0:G.padding)||8)+"px",zIndex:e.z_index,cursor:"pointer",pointerEvents:"all",transition:"all 0.3s ease",border:(H=e.styling)!=null&&H.borderColor?`2px solid ${e.styling.borderColor}`:"none",textAlign:((X=e.styling)==null?void 0:X.textAlign)||"center"}),class:"hover:scale-105 hover:shadow-lg",onClick:ne=>ge(e)},[e.type==="text"?(u(),r("div",We,i(((J=e.content)==null?void 0:J.text)||"Text Element"),1)):e.type==="image"?(u(),r("img",{key:1,src:Ce(e),alt:((O=e.content)==null?void 0:O.alt)||"Image",class:"w-full h-full object-cover rounded"},null,8,et)):e.type==="button"?(u(),r("button",{key:2,class:"w-full h-full flex items-center justify-center font-medium hover:opacity-80 transition-opacity",style:N({backgroundColor:((W=e.styling)==null?void 0:W.backgroundColor)||"#007bff",color:((ee=e.styling)==null?void 0:ee.textColor)||"#ffffff"})},i(((te=e.content)==null?void 0:te.text)||"Click Me"),5)):e.type==="quiz"?(u(),r("div",tt,[t("div",st,i(((se=e.content)==null?void 0:se.question)||"Quiz Question"),1),t("div",ot,[(u(!0),r(V,null,$(((oe=e.content)==null?void 0:oe.options)||[],(ne,ie)=>(u(),r("div",{key:ie,class:"text-xs p-1 bg-gray-100 rounded cursor-pointer hover:bg-gray-200",onClick:Ie(Bt=>me(e,ie),["stop"])},i(ne),9,lt))),128))])])):e.type==="link"?(u(),r("a",{key:4,href:(le=e.content)==null?void 0:le.url,target:"_blank",class:"w-full h-full flex items-center justify-center text-blue-600 hover:text-blue-800 underline"},i(((ae=e.content)==null?void 0:ae.text)||"Click Here"),9,at)):e.type==="shape"?(u(),r("div",nt)):(u(),r("div",it,i(e.type)+" Element ",1))],12,Oe)}),128))]),p.value?M("",!0):(u(),r("div",{key:2,class:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 cursor-pointer opacity-0 group-hover:opacity-100 transition-opacity",onClick:I},[a(l(re),{class:"h-16 w-16 text-white"})])),y.value===0?(u(),r("div",ut,o[6]||(o[6]=[t("div",{class:"text-white"},"Loading video...",-1)]))):M("",!0)]),t("div",rt,[t("div",dt,[t("div",ct,[t("span",null,i(x(v.value)),1),t("span",null,i(x(y.value)),1)]),t("div",ft,[t("div",vt,[t("div",{class:"h-2 bg-primary rounded-full transition-all duration-100",style:N({width:y.value>0?v.value/y.value*100+"%":"0%"})},null,4)]),t("input",{type:"range",value:v.value,max:y.value,step:.1,onInput:o[0]||(o[0]=e=>fe(parseFloat(e.target.value))),class:"absolute inset-0 w-full h-2 opacity-0 cursor-pointer"},null,40,pt)])]),t("div",_t,[t("div",yt,[a(l(k),{onClick:I,variant:"outline",size:"sm"},{default:n(()=>[p.value?(u(),A(l(Me),{key:1,class:"h-4 w-4"})):(u(),A(l(re),{key:0,class:"h-4 w-4"}))]),_:1}),a(l(k),{onClick:K,variant:"outline",size:"sm"},{default:n(()=>[a(l($e),{class:"h-4 w-4"})]),_:1}),t("div",gt,[a(l(k),{onClick:B,variant:"outline",size:"sm"},{default:n(()=>[g.value?(u(),A(l(Re),{key:1,class:"h-4 w-4"})):(u(),A(l(Ne),{key:0,class:"h-4 w-4"}))]),_:1}),t("div",mt,[t("input",{type:"range",value:Y.value,min:"0",max:"1",step:"0.1",onInput:o[1]||(o[1]=e=>ve(parseFloat(e.target.value))),class:"w-full"},null,40,ht)])])]),a(l(k),{onClick:U,variant:"outline",size:"sm"},{default:n(()=>[a(l(De),{class:"h-4 w-4"})]),_:1})])])]),_:1})]),_:1})]),t("div",bt,[a(l(P),null,{default:n(()=>[a(l(E),null,{default:n(()=>[a(l(j),null,{default:n(()=>o[7]||(o[7]=[b("Video Info",-1)])),_:1,__:[7]})]),_:1}),a(l(S),{class:"space-y-2"},{default:n(()=>{var e;return[t("div",null,[t("h3",xt,i(s.video.title),1),t("p",wt,i(s.video.description||"No description"),1)]),t("div",kt,[t("p",null,"Duration: "+i(x(y.value)),1),t("p",null,"Elements: "+i(((e=s.video.interactive_elements)==null?void 0:e.length)||0),1),t("p",null,"Source: "+i(s.video.source_type==="youtube"?"YouTube":"Upload"),1)])]}),_:1})]),_:1}),a(l(P),null,{default:n(()=>[a(l(E),null,{default:n(()=>[a(l(j),null,{default:n(()=>o[8]||(o[8]=[b("Active Elements",-1)])),_:1,__:[8]}),a(l(D),null,{default:n(()=>o[9]||(o[9]=[b(" Elements currently visible ",-1)])),_:1,__:[9]})]),_:1}),a(l(S),null,{default:n(()=>[z.value.length?(u(),r("div",Tt,[(u(!0),r(V,null,$(z.value,e=>{var f;return u(),r("div",{key:e.id,class:"p-2 border rounded text-sm"},[t("div",Ct,i(e.name||e.type),1),t("div",Pt,i(e.type),1),t("div",Et,i(e.start_time)+"s - "+i(e.end_time||e.start_time+e.duration)+"s ",1),(f=e.content)!=null&&f.text?(u(),r("div",jt,' "'+i(e.content.text)+'" ',1)):M("",!0)])}),128))])):(u(),r("div",St," No elements active at "+i(x(v.value)),1))]),_:1})]),_:1}),a(l(P),null,{default:n(()=>[a(l(E),null,{default:n(()=>[a(l(j),null,{default:n(()=>o[10]||(o[10]=[b("Debug Info",-1)])),_:1,__:[10]}),a(l(D),null,{default:n(()=>o[11]||(o[11]=[b(" Current video state ",-1)])),_:1,__:[11]})]),_:1}),a(l(S),{class:"space-y-2 text-xs"},{default:n(()=>{var e;return[t("div",Yt,[o[12]||(o[12]=t("span",null,"Current Time:",-1)),t("span",It,i(x(v.value)),1)]),t("div",zt,[o[13]||(o[13]=t("span",null,"Duration:",-1)),t("span",Vt,i(x(y.value)),1)]),t("div",At,[o[14]||(o[14]=t("span",null,"Playing:",-1)),t("span",Ft,i(p.value?"Yes":"No"),1)]),t("div",Mt,[o[15]||(o[15]=t("span",null,"YouTube:",-1)),t("span",$t,i(m.value?"Yes":"No"),1)]),t("div",Nt,[o[16]||(o[16]=t("span",null,"Total Elements:",-1)),t("span",Rt,i(((e=s.video.interactive_elements)==null?void 0:e.length)||0),1)]),t("div",Dt,[o[17]||(o[17]=t("span",null,"Visible Elements:",-1)),t("span",Lt,i(z.value.length),1)])]}),_:1})]),_:1}),a(l(P),null,{default:n(()=>[a(l(E),null,{default:n(()=>[a(l(j),null,{default:n(()=>o[18]||(o[18]=[b("Shortcuts",-1)])),_:1,__:[18]})]),_:1}),a(l(S),{class:"space-y-2 text-sm"},{default:n(()=>o[19]||(o[19]=[t("div",{class:"flex justify-between"},[t("span",null,"Play/Pause:"),t("kbd",{class:"px-2 py-1 bg-muted rounded text-xs"},"Space")],-1),t("div",{class:"flex justify-between"},[t("span",null,"Mute:"),t("kbd",{class:"px-2 py-1 bg-muted rounded text-xs"},"M")],-1),t("div",{class:"flex justify-between"},[t("span",null,"Fullscreen:"),t("kbd",{class:"px-2 py-1 bg-muted rounded text-xs"},"F")],-1),t("div",{class:"flex justify-between"},[t("span",null,"Restart:"),t("kbd",{class:"px-2 py-1 bg-muted rounded text-xs"},"R")],-1)])),_:1,__:[19]})]),_:1})])])])]),_:1})],64))}});export{ss as default};
